
FROM node:24 
WORKDIR /app

COPY . .


# Use BuildKit cache mount for pnpm store to avoid re-downloading packages on every build.
# The `--mount=type=cache` requires Docker BuildKit (used by buildx).
RUN --mount=type=cache,id=pnpm-store,target=/root/.pnpm-store \
	npm install -g pnpm && \
	pnpm install --store=/root/.pnpm-store --frozen-lockfile

RUN pnpm run build

EXPOSE 8000

CMD ["pnpm", "--filter", "@txtalk/api", "start"]